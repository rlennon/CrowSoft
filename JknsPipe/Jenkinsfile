pipeline {
  agent any
  stages {
    stage('Checkout code') {
	  	steps {
		  	checkout scm				
				}
			}	
    stage('Run NUnit Test') {
	  	steps {
		  		echo 'Nunit test will go in here'			
				}
			}	
		
    stage('Test ssh publisher ') {
	  	steps {
		  		sshPublisher(publishers: [sshPublisherDesc(configName: 'PublishOverSSHDevConn133', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: '', execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '/home/devadmin/TEST', remoteDirectorySDF: false, removePrefix: 'Projects/crowsoft_unittests/', sourceFiles: 'Projects/crowsoft_unittests/appconfig.json')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])			
				}
			}	
	 stage('Stop app') {
	  	steps {
				sshagent(['dev']) {
				sh label: '', script: 'echo is this working without the ssh step inside' 
					
					}
		  				
				}
			}	
	 
	stage('Startapp') {
	  	steps {
		  	sshagent(['dev']) {
				sh label: '', script: 'pwd' 				
				}
			}	
	  }


 }

